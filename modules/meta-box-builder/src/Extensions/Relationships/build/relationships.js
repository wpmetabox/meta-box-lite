(()=>{"use strict";var e={70:(e,t,o)=>{e.exports=o(462)},81:(e,t,o)=>{var r=o(609),n=o(143),i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=n.useSyncExternalStore,l=r.useRef,s=r.useEffect,d=r.useMemo,u=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,o,r,n){var c=l(null);if(null===c.current){var p={hasValue:!1,value:null};c.current=p}else p=c.current;c=d((function(){function e(e){if(!s){if(s=!0,a=e,e=r(e),void 0!==n&&p.hasValue){var t=p.value;if(n(t,e))return l=t}return l=e}if(t=l,i(a,e))return t;var o=r(e);return void 0!==n&&n(t,o)?t:(a=e,l=o)}var a,l,s=!1,d=void 0===o?null:o;return[function(){return e(t())},null===d?void 0:function(){return e(d())}]}),[t,o,r,n]);var m=a(e,c[0],c[1]);return s((function(){p.hasValue=!0,p.value=m}),[m]),u(m),m}},96:e=>{e.exports=wp.CodeMirror},143:(e,t,o)=>{e.exports=o(878)},388:(e,t,o)=>{function r(){return r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},r.apply(this,arguments)}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}var i,a=(i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},i(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)});t.wN=void 0;var l,s=o(609),d="undefined"==typeof window||void 0!==o.g&&!0===o.g.PREVENT_CODEMIRROR_RENDER;d||(l=o(96));var u=function(){function e(){}return e.equals=function(e,t){var o=this,r=Object.keys,i=n(e),a=n(t);return e&&t&&"object"===i&&i===a?r(e).length===r(t).length&&r(e).every((function(r){return o.equals(e[r],t[r])})):e===t},e}(),c=function(){function e(e,t){this.editor=e,this.props=t}return e.prototype.delegateCursor=function(e,t,o){var r=this.editor.getDoc();o&&this.editor.focus(),t?r.setCursor(e):r.setCursor(e,null,{scroll:!1})},e.prototype.delegateScroll=function(e){this.editor.scrollTo(e.x,e.y)},e.prototype.delegateSelection=function(e,t){this.editor.getDoc().setSelections(e),t&&this.editor.focus()},e.prototype.apply=function(e){e&&e.selection&&e.selection.ranges&&this.delegateSelection(e.selection.ranges,e.selection.focus||!1),e&&e.cursor&&this.delegateCursor(e.cursor,e.autoScroll||!1,this.editor.getOption("autofocus")||!1),e&&e.scroll&&this.delegateScroll(e.scroll)},e.prototype.applyNext=function(e,t,o){e&&e.selection&&e.selection.ranges&&t&&t.selection&&t.selection.ranges&&!u.equals(e.selection.ranges,t.selection.ranges)&&this.delegateSelection(t.selection.ranges,t.selection.focus||!1),e&&e.cursor&&t&&t.cursor&&!u.equals(e.cursor,t.cursor)&&this.delegateCursor(o.cursor||t.cursor,t.autoScroll||!1,t.autoCursor||!1),e&&e.scroll&&t&&t.scroll&&!u.equals(e.scroll,t.scroll)&&this.delegateScroll(t.scroll)},e.prototype.applyUserDefined=function(e,t){t&&t.cursor&&this.delegateCursor(t.cursor,e.autoScroll||!1,this.editor.getOption("autofocus")||!1)},e.prototype.wire=function(e){var t=this;Object.keys(e||{}).filter((function(e){return/^on/.test(e)})).forEach((function(e){switch(e){case"onBlur":t.editor.on("blur",(function(e,o){t.props.onBlur(t.editor,o)}));break;case"onContextMenu":t.editor.on("contextmenu",(function(e,o){t.props.onContextMenu(t.editor,o)}));break;case"onCopy":t.editor.on("copy",(function(e,o){t.props.onCopy(t.editor,o)}));break;case"onCursor":t.editor.on("cursorActivity",(function(e){t.props.onCursor(t.editor,t.editor.getDoc().getCursor())}));break;case"onCursorActivity":t.editor.on("cursorActivity",(function(e){t.props.onCursorActivity(t.editor)}));break;case"onCut":t.editor.on("cut",(function(e,o){t.props.onCut(t.editor,o)}));break;case"onDblClick":t.editor.on("dblclick",(function(e,o){t.props.onDblClick(t.editor,o)}));break;case"onDragEnter":t.editor.on("dragenter",(function(e,o){t.props.onDragEnter(t.editor,o)}));break;case"onDragLeave":t.editor.on("dragleave",(function(e,o){t.props.onDragLeave(t.editor,o)}));break;case"onDragOver":t.editor.on("dragover",(function(e,o){t.props.onDragOver(t.editor,o)}));break;case"onDragStart":t.editor.on("dragstart",(function(e,o){t.props.onDragStart(t.editor,o)}));break;case"onDrop":t.editor.on("drop",(function(e,o){t.props.onDrop(t.editor,o)}));break;case"onFocus":t.editor.on("focus",(function(e,o){t.props.onFocus(t.editor,o)}));break;case"onGutterClick":t.editor.on("gutterClick",(function(e,o,r,n){t.props.onGutterClick(t.editor,o,r,n)}));break;case"onInputRead":t.editor.on("inputRead",(function(e,o){t.props.onInputRead(t.editor,o)}));break;case"onKeyDown":t.editor.on("keydown",(function(e,o){t.props.onKeyDown(t.editor,o)}));break;case"onKeyHandled":t.editor.on("keyHandled",(function(e,o,r){t.props.onKeyHandled(t.editor,o,r)}));break;case"onKeyPress":t.editor.on("keypress",(function(e,o){t.props.onKeyPress(t.editor,o)}));break;case"onKeyUp":t.editor.on("keyup",(function(e,o){t.props.onKeyUp(t.editor,o)}));break;case"onMouseDown":t.editor.on("mousedown",(function(e,o){t.props.onMouseDown(t.editor,o)}));break;case"onPaste":t.editor.on("paste",(function(e,o){t.props.onPaste(t.editor,o)}));break;case"onRenderLine":t.editor.on("renderLine",(function(e,o,r){t.props.onRenderLine(t.editor,o,r)}));break;case"onScroll":t.editor.on("scroll",(function(e){t.props.onScroll(t.editor,t.editor.getScrollInfo())}));break;case"onSelection":t.editor.on("beforeSelectionChange",(function(e,o){t.props.onSelection(t.editor,o)}));break;case"onTouchStart":t.editor.on("touchstart",(function(e,o){t.props.onTouchStart(t.editor,o)}));break;case"onUpdate":t.editor.on("update",(function(e){t.props.onUpdate(t.editor)}));break;case"onViewportChange":t.editor.on("viewportChange",(function(e,o,r){t.props.onViewportChange(t.editor,o,r)}))}}))},e}();!function(e){function t(t){var o=e.call(this,t)||this;return d||(o.applied=!1,o.appliedNext=!1,o.appliedUserDefined=!1,o.deferred=null,o.emulating=!1,o.hydrated=!1,o.initCb=function(){o.props.editorDidConfigure&&o.props.editorDidConfigure(o.editor)},o.mounted=!1),o}a(t,e),t.prototype.hydrate=function(e){var t=this,o=e&&e.options?e.options:{},n=r({},l.defaults,this.editor.options,o);Object.keys(n).some((function(e){return t.editor.getOption(e)!==n[e]}))&&Object.keys(n).forEach((function(e){o.hasOwnProperty(e)&&t.editor.getOption(e)!==n[e]&&(t.editor.setOption(e,n[e]),t.mirror.setOption(e,n[e]))})),this.hydrated||(this.deferred?this.resolveChange(e.value):this.initChange(e.value||"")),this.hydrated=!0},t.prototype.initChange=function(e){this.emulating=!0;var t=this.editor.getDoc(),o=t.lastLine(),r=t.getLine(t.lastLine()).length;t.replaceRange(e||"",{line:0,ch:0},{line:o,ch:r}),this.mirror.setValue(e),t.clearHistory(),this.mirror.clearHistory(),this.emulating=!1},t.prototype.resolveChange=function(e){this.emulating=!0;var t=this.editor.getDoc();if("undo"===this.deferred.origin?t.undo():"redo"===this.deferred.origin?t.redo():t.replaceRange(this.deferred.text,this.deferred.from,this.deferred.to,this.deferred.origin),e&&e!==t.getValue()){var o=t.getCursor();t.setValue(e),t.setCursor(o)}this.emulating=!1,this.deferred=null},t.prototype.mirrorChange=function(e){var t=this.editor.getDoc();return"undo"===e.origin?(t.setHistory(this.mirror.getHistory()),this.mirror.undo()):"redo"===e.origin?(t.setHistory(this.mirror.getHistory()),this.mirror.redo()):this.mirror.replaceRange(e.text,e.from,e.to,e.origin),this.mirror.getValue()},t.prototype.componentDidMount=function(){var e=this;d||(this.props.defineMode&&this.props.defineMode.name&&this.props.defineMode.fn&&l.defineMode(this.props.defineMode.name,this.props.defineMode.fn),this.editor=l(this.ref,this.props.options),this.shared=new c(this.editor,this.props),this.mirror=l((function(){}),this.props.options),this.editor.on("electricInput",(function(){e.mirror.setHistory(e.editor.getDoc().getHistory())})),this.editor.on("cursorActivity",(function(){e.mirror.setCursor(e.editor.getDoc().getCursor())})),this.editor.on("beforeChange",(function(t,o){if(!e.emulating){o.cancel(),e.deferred=o;var r=e.mirrorChange(e.deferred);e.props.onBeforeChange&&e.props.onBeforeChange(e.editor,e.deferred,r)}})),this.editor.on("change",(function(t,o){e.mounted&&e.props.onChange&&e.props.onChange(e.editor,o,e.editor.getValue())})),this.hydrate(this.props),this.shared.apply(this.props),this.applied=!0,this.mounted=!0,this.shared.wire(this.props),this.editor.getOption("autofocus")&&this.editor.focus(),this.props.editorDidMount&&this.props.editorDidMount(this.editor,this.editor.getValue(),this.initCb))},t.prototype.componentDidUpdate=function(e){if(!d){var t={cursor:null};this.props.value!==e.value&&(this.hydrated=!1),this.props.autoCursor||void 0===this.props.autoCursor||(t.cursor=this.editor.getDoc().getCursor()),this.hydrate(this.props),this.appliedNext||(this.shared.applyNext(e,this.props,t),this.appliedNext=!0),this.shared.applyUserDefined(e,t),this.appliedUserDefined=!0}},t.prototype.componentWillUnmount=function(){d||this.props.editorWillUnmount&&this.props.editorWillUnmount(l)},t.prototype.shouldComponentUpdate=function(e,t){return!d},t.prototype.render=function(){var e=this;if(d)return null;var t=this.props.className?"react-codemirror2 ".concat(this.props.className):"react-codemirror2";return s.createElement("div",{className:t,ref:function(t){return e.ref=t}})}}(s.Component);var p=function(e){function t(t){var o=e.call(this,t)||this;return d||(o.applied=!1,o.appliedUserDefined=!1,o.continueChange=!1,o.detached=!1,o.hydrated=!1,o.initCb=function(){o.props.editorDidConfigure&&o.props.editorDidConfigure(o.editor)},o.mounted=!1,o.onBeforeChangeCb=function(){o.continueChange=!0}),o}return a(t,e),t.prototype.hydrate=function(e){var t=this,o=e&&e.options?e.options:{},n=r({},l.defaults,this.editor.options,o);if(Object.keys(n).some((function(e){return t.editor.getOption(e)!==n[e]}))&&Object.keys(n).forEach((function(e){o.hasOwnProperty(e)&&t.editor.getOption(e)!==n[e]&&t.editor.setOption(e,n[e])})),!this.hydrated){var i=this.editor.getDoc(),a=i.lastLine(),s=i.getLine(i.lastLine()).length;i.replaceRange(e.value||"",{line:0,ch:0},{line:a,ch:s})}this.hydrated=!0},t.prototype.componentDidMount=function(){var e=this;d||(this.detached=!0===this.props.detach,this.props.defineMode&&this.props.defineMode.name&&this.props.defineMode.fn&&l.defineMode(this.props.defineMode.name,this.props.defineMode.fn),this.editor=l(this.ref,this.props.options),this.shared=new c(this.editor,this.props),this.editor.on("beforeChange",(function(t,o){e.props.onBeforeChange&&e.props.onBeforeChange(e.editor,o,e.editor.getValue(),e.onBeforeChangeCb)})),this.editor.on("change",(function(t,o){e.mounted&&e.props.onChange&&(e.props.onBeforeChange?e.continueChange&&e.props.onChange(e.editor,o,e.editor.getValue()):e.props.onChange(e.editor,o,e.editor.getValue()))})),this.hydrate(this.props),this.shared.apply(this.props),this.applied=!0,this.mounted=!0,this.shared.wire(this.props),this.editor.getDoc().clearHistory(),this.props.editorDidMount&&this.props.editorDidMount(this.editor,this.editor.getValue(),this.initCb))},t.prototype.componentDidUpdate=function(e){if(this.detached&&!1===this.props.detach&&(this.detached=!1,e.editorDidAttach&&e.editorDidAttach(this.editor)),this.detached||!0!==this.props.detach||(this.detached=!0,e.editorDidDetach&&e.editorDidDetach(this.editor)),!d&&!this.detached){var t={cursor:null};this.props.value!==e.value&&(this.hydrated=!1,this.applied=!1,this.appliedUserDefined=!1),e.autoCursor||void 0===e.autoCursor||(t.cursor=this.editor.getDoc().getCursor()),this.hydrate(this.props),this.applied||(this.shared.apply(e),this.applied=!0),this.appliedUserDefined||(this.shared.applyUserDefined(e,t),this.appliedUserDefined=!0)}},t.prototype.componentWillUnmount=function(){d||this.props.editorWillUnmount&&this.props.editorWillUnmount(l)},t.prototype.shouldComponentUpdate=function(e,t){var o=!0;return d&&(o=!1),this.detached&&e.detach&&(o=!1),o},t.prototype.render=function(){var e=this;if(d)return null;var t=this.props.className?"react-codemirror2 ".concat(this.props.className):"react-codemirror2";return s.createElement("div",{className:t,ref:function(t){return e.ref=t}})},t}(s.Component);t.wN=p},462:(e,t,o)=>{var r=o(609),n=Symbol.for("react.element"),i=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};t.jsx=function(e,t,o){var r,s={},d=null,u=null;for(r in void 0!==o&&(d=""+o),void 0!==t.key&&(d=""+t.key),void 0!==t.ref&&(u=t.ref),t)i.call(t,r)&&!l.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:n,type:e,key:d,ref:u,props:s,_owner:a.current}}},471:e=>{e.exports=e=>{const t=typeof e;return null!==e&&("object"===t||"function"===t)}},609:e=>{e.exports=window.React},688:(e,t,o)=>{const r=o(471),n=new Set(["__proto__","prototype","constructor"]);function i(e){const t=e.split("."),o=[];for(let e=0;e<t.length;e++){let r=t[e];for(;"\\"===r[r.length-1]&&void 0!==t[e+1];)r=r.slice(0,-1)+".",r+=t[++e];o.push(r)}return o.some((e=>n.has(e)))?[]:o}e.exports={get(e,t,o){if(!r(e)||"string"!=typeof t)return void 0===o?e:o;const n=i(t);if(0!==n.length){for(let t=0;t<n.length;t++)if(null==(e=e[n[t]])){if(t!==n.length-1)return o;break}return void 0===e?o:e}},set(e,t,o){if(!r(e)||"string"!=typeof t)return e;const n=e,a=i(t);for(let t=0;t<a.length;t++){const n=a[t];r(e[n])||(e[n]={}),t===a.length-1&&(e[n]=o),e=e[n]}return n},delete(e,t){if(!r(e)||"string"!=typeof t)return!1;const o=i(t);for(let t=0;t<o.length;t++){const n=o[t];if(t===o.length-1)return delete e[n],!0;if(e=e[n],!r(e))return!1}},has(e,t){if(!r(e)||"string"!=typeof t)return!1;const o=i(t);if(0===o.length)return!1;for(let t=0;t<o.length;t++){if(!r(e))return!1;if(!(o[t]in e))return!1;e=e[o[t]]}return!0}}},741:(e,t,o)=>{e.exports=o(81)},878:(e,t,o)=>{var r=o(609),n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=r.useState,a=r.useEffect,l=r.useLayoutEffect,s=r.useDebugValue;function d(e){var t=e.getSnapshot;e=e.value;try{var o=t();return!n(e,o)}catch(e){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var o=t(),r=i({inst:{value:o,getSnapshot:t}}),n=r[0].inst,u=r[1];return l((function(){n.value=o,n.getSnapshot=t,d(n)&&u({inst:n})}),[e,o,t]),a((function(){return d(n)&&u({inst:n}),e((function(){d(n)&&u({inst:n})}))}),[e]),s(o),o};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:u}},t={};function o(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,o),i.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r=o(609),n=o.n(r);const i=window.wp.element,a=window.wp.i18n,l=(0,r.createContext)(null),s={didCatch:!1,error:null};class d extends r.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=s}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){const{error:e}=this.state;if(null!==e){for(var t,o,r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];null===(t=(o=this.props).onReset)||void 0===t||t.call(o,{args:n,reason:"imperative-api"}),this.setState(s)}}componentDidCatch(e,t){var o,r;null===(o=(r=this.props).onError)||void 0===o||o.call(r,e,t)}componentDidUpdate(e,t){const{didCatch:o}=this.state,{resetKeys:r}=this.props;var n,i;o&&null!==t.error&&function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.length!==t.length||e.some(((e,o)=>!Object.is(e,t[o])))}(e.resetKeys,r)&&(null===(n=(i=this.props).onReset)||void 0===n||n.call(i,{next:r,prev:e.resetKeys,reason:"keys"}),this.setState(s))}render(){const{children:e,fallbackRender:t,FallbackComponent:o,fallback:n}=this.props,{didCatch:i,error:a}=this.state;let s=e;if(i){const e={error:a,resetErrorBoundary:this.resetErrorBoundary};if("function"==typeof t)s=t(e);else if(o)s=(0,r.createElement)(o,e);else{if(void 0===n)throw a;s=n}}return(0,r.createElement)(l.Provider,{value:{didCatch:i,error:a,resetErrorBoundary:this.resetErrorBoundary}},s)}}var u=o(688),c=o.n(u);const p=window.lodash,m=(e,t=" ",o=" ")=>e.split(t).map(p.upperFirst).join(o),f=()=>Math.random().toString(36).substr(2),h=e=>Array.isArray(e)?e:e?"object"==typeof e?Object.values(e):[e]:[],b=e=>e.replace("[]","").replace(/\[(.+?)\]/g,".$1"),g=window.wp.components;var _,y;function v(){return v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)({}).hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},v.apply(null,arguments)}var x=function(e){return r.createElement("svg",v({xmlns:"http://www.w3.org/2000/svg",width:46,height:46,fill:"none"},e),_||(_=r.createElement("rect",{width:46,height:46,fill:"#000",rx:3})),y||(y=r.createElement("path",{fill:"#fff",d:"M8.688 35v-2.563l2.271-.44V16.69l-2.27-.439v-2.578h8.598l5.816 14.868h.087l5.625-14.868h8.614v2.578l-2.285.44v15.307l2.285.44V35h-8.833v-2.563l2.387-.44V27.91l.074-9.624-.088-.015-6.372 16.436h-3.238l-6.518-16.304-.088.015.249 9.053v4.526l2.52.44V35z"})))};const E=()=>(0,r.createElement)(g.Flex,{className:"mb-header"},(0,r.createElement)(g.Tooltip,{delay:0,text:(0,a.__)("Back to all relationships","meta-box-builder"),placement:"bottom"},(0,r.createElement)("a",{className:"mb-header__logo",href:MbbApp.url},(0,r.createElement)(x,null))),(0,r.createElement)(g.Flex,{gap:0,expanded:!1,className:"mb-header__info"},(0,r.createElement)("input",{type:"text",name:"post_title",id:"post_title",defaultValue:MbbApp.title,placeholder:(0,a.__)("Please enter the relationship title...","meta-box-builder")})),(0,r.createElement)("input",{type:"submit",className:"components-button is-primary",value:(0,a.__)("Save Changes","meta-box-builder")})),w=window.wp.primitives;var S=o(70);const C=(0,S.jsx)(w.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,S.jsx)(w.Path,{d:"M6 5.5h3a.5.5 0 01.5.5v3a.5.5 0 01-.5.5H6a.5.5 0 01-.5-.5V6a.5.5 0 01.5-.5zM4 6a2 2 0 012-2h3a2 2 0 012 2v3a2 2 0 01-2 2H6a2 2 0 01-2-2V6zm11-.5h3a.5.5 0 01.5.5v3a.5.5 0 01-.5.5h-3a.5.5 0 01-.5-.5V6a.5.5 0 01.5-.5zM13 6a2 2 0 012-2h3a2 2 0 012 2v3a2 2 0 01-2 2h-3a2 2 0 01-2-2V6zm5 8.5h-3a.5.5 0 00-.5.5v3a.5.5 0 00.5.5h3a.5.5 0 00.5-.5v-3a.5.5 0 00-.5-.5zM15 13a2 2 0 00-2 2v3a2 2 0 002 2h3a2 2 0 002-2v-3a2 2 0 00-2-2h-3zm-9 1.5h3a.5.5 0 01.5.5v3a.5.5 0 01-.5.5H6a.5.5 0 01-.5-.5v-3a.5.5 0 01.5-.5zM4 15a2 2 0 012-2h3a2 2 0 012 2v3a2 2 0 01-2 2H6a2 2 0 01-2-2v-3z",fillRule:"evenodd",clipRule:"evenodd"})}),k=(0,S.jsx)(w.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,S.jsx)(w.Path,{d:"M20.8 10.7l-4.3-4.3-1.1 1.1 4.3 4.3c.1.1.1.3 0 .4l-4.3 4.3 1.1 1.1 4.3-4.3c.7-.8.7-1.9 0-2.6zM4.2 11.8l4.3-4.3-1-1-4.3 4.3c-.7.7-.7 1.8 0 2.5l4.3 4.3 1.1-1.1-4.3-4.3c-.2-.1-.2-.3-.1-.4z"})}),F=e=>{const[t,o]=(0,i.useState)((()=>()=>{})),r=D(e),n=r?r.closest(".og-field"):null,a=n?n.classList:"";return(0,i.useEffect)((()=>{const e=()=>r&&$(r);o((()=>e)),setTimeout(e,200)}),[e,a]),t},D=e=>"string"==typeof e?document.getElementById(e):e,$=e=>{const t="checkbox"===e.type?e.checked:e.value,o=e.closest(".og-field");N(e).forEach((e=>{const r="true"===(n=e.className.match(/dep:([^:]+):([^:\s]+)/)[2])||"false"!==n&&n;var n;o.classList.contains("og-is-hidden")||("string"==typeof r&&r.includes("[")&&r.includes("]")?!r.match(/[^[\],]+/g).includes(t):r!==t)?e.classList.add("og-is-hidden"):e.classList.remove("og-is-hidden"),e.querySelectorAll(".og-input > input, .og-input > select").forEach($)}))},N=e=>{const t=e.closest(".og-item")||e.closest(".og"),o=O(e.id);return t?[...t.querySelectorAll(`[class*="dep:${o}:"]`)]:[]},O=e=>{const t=e.match(/-([^-]*)$/);return t?t[1]:e},V=({content:e})=>(0,r.createElement)(g.Tooltip,{text:e,delay:0,placement:"bottom"},(0,r.createElement)("span",{className:"og-tooltip-icon"},(0,r.createElement)(g.Dashicon,{icon:"editor-help"}))),j=({children:e,label:t,description:o,tooltip:n,className:a="",htmlFor:l="",keyValue:s="",required:d=!1,dependency:u,error:c})=>(0,r.createElement)("div",{className:`og-field ${a} ${u?`dep:${u}`:""}`,key:s},t&&(0,r.createElement)("label",{className:"og-label",htmlFor:l},(0,r.createElement)(i.RawHTML,null,t),d&&(0,r.createElement)("span",{className:"og-required"},"*"),n&&(0,r.createElement)(V,{id:l,content:n})),(0,r.createElement)("div",{className:"og-input"},e,o&&(0,r.createElement)(i.RawHTML,{className:"og-description"},o),c&&(0,r.createElement)("p",{className:"og-error"},c))),M=({name:e,componentId:t,label:o,className:n,defaultValue:i,updateField:a,...l})=>{const s=F(t);return(0,r.createElement)(j,{label:o,className:`og-field--checkbox ${n}`,htmlFor:t,...l},(0,r.createElement)("label",{className:"og-toggle"},(0,r.createElement)("input",{type:"checkbox",id:t,onChange:t=>{s(),a(e,t.target.checked)},defaultChecked:i}),(0,r.createElement)("div",{className:"og-toggle__switch"})))},P=({name:e,componentId:t,placeholder:o,defaultValue:n,type:i="text",updateField:a,...l})=>(0,r.createElement)(j,{htmlFor:t,...l},(0,r.createElement)("input",{type:i,id:t,defaultValue:n,onChange:t=>a(e,t.target.value),placeholder:o,required:l.required})),T=e=>{let t;const o=new Set,r=(e,r)=>{const n="function"==typeof e?e(t):e;if(!Object.is(n,t)){const e=t;t=(null!=r?r:"object"!=typeof n||null===n)?n:Object.assign({},t,n),o.forEach((o=>o(t,e)))}},n=()=>t,i={setState:r,getState:n,getInitialState:()=>a,subscribe:e=>(o.add(e),()=>o.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),o.clear()}},a=t=e(r,n,i);return i};var A=o(741);const{useDebugValue:R}=r,{useSyncExternalStoreWithSelector:L}=A;let I=!1;const B=e=>e,U=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t="function"==typeof e?(e=>e?T(e):T)(e):e,o=(e,o)=>function(e,t=B,o){o&&!I&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),I=!0);const r=L(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,o);return R(r),r}(t,e,o);return Object.assign(o,t),o},z=e=>e?U(e):U,H=()=>{const e=(t=window.location.search,(e=>{const t={};for(let[o,r]of e){o=b(o);const e=c().get(t,o);void 0!==e&&(r=Array.isArray(e)?[...e,r]:[e,r]),r="false"!==r&&r,c().set(t,o,r)}return t})(new URLSearchParams(t)));var t;return{...MbbApp.settings||{},...e.settings}},q=e=>(e&&Array.isArray(e)?e:["post"]).filter((e=>/\S/.test(e))),W=z(((e,t)=>({settings:H(),getPrefix:()=>t().getSetting("prefix",""),updatePrefix:e=>t().updateSetting("prefix",e),getObjectType:()=>t().getSetting("object_type","post"),validateAndUpdateObjectType:()=>{const e=t().getSetting("object_type","post"),o={block:"blocks",term:"termMeta",user:"userMeta",comment:"commentMeta",setting:"settingsPage"}[e],r=!o||MbbApp.extensions[o]?e:"post";return r!==e&&t().updateSetting("object_type",r),r},updateObjectType:o=>{const r="object_type",n=t().settings;if(c().get(n,r)===o)return;const i=structuredClone(n);c().set(i,r,o),"post"===o?(c().delete(i,"taxonomies"),c().delete(i,"settings_pages"),c().delete(i,"type")):"term"===o?(c().delete(i,"post_types"),c().delete(i,"settings_pages"),c().delete(i,"type")):"setting"===o?(c().delete(i,"post_types"),c().delete(i,"taxonomies"),c().delete(i,"type")):["block","user","comment"].includes(o)&&(c().delete(i,"post_types"),c().delete(i,"taxonomies"),c().delete(i,"settings_pages")),e({settings:i})},getPostTypes:()=>q(h(t().getSetting("post_types",["post"]))),updatePostTypes:e=>t().updateSetting("post_types",q(e)),getSetting:(e,o=null)=>c().get(t().settings,e,o),updateSetting:(o,r)=>{const n=t().settings;if(c().get(n,o)===r)return;const i=structuredClone(n);c().set(i,o,r),e({settings:i})}}))),G=()=>{const{getSetting:e,updateSetting:t}=W();return(0,r.createElement)(r.Fragment,null,(0,r.createElement)(P,{name:"id",label:(0,a.__)("ID","meta-box-builder"),description:(0,a.__)("Must be unique between relationships. Use only lowercase letters, numbers, underscores (not recommended dashes).","meta-box-builder"),defaultValue:e("id"),updateField:t}),(0,r.createElement)(M,{name:"delete_data",componentId:"settings-delete-data",label:(0,a.__)("Delete data in database?"),defaultValue:!!e("delete_data"),className:"relationships-plain",description:(0,a.__)("Delete data in database when the relationship is deleted.","meta-box-builder"),updateField:t}),(0,r.createElement)(M,{name:"reciprocal",componentId:"settings-reciprocal",label:(0,a.__)("Reciprocal relationship"),defaultValue:!!e("reciprocal"),className:"relationships-plain",description:(0,a.__)("Enable only if two sides of the relationship are the same.","meta-box-builder"),updateField:t}))},K=({handleSearch:e})=>(0,r.createElement)("div",{className:"og-dropdown__search"},(0,r.createElement)("input",{onInput:e,type:"text",placeholder:(0,a.__)("Search...","meta-box-builder")})),Q=({items:e,searchTerm:t})=>{const o=t.toLowerCase();return 0===(e=e.filter((e=>!o||(Array.isArray(e)?e[1]:e).toLowerCase().includes(o)))).length?(0,r.createElement)(i.RawHTML,{className:"og-description"},(0,a.__)("No items found","meta-box-builder")):e.map((e=>{const t=Array.isArray(e)?e[1]:e,o=Array.isArray(e)?e[0]:e;return(0,r.createElement)(i.RawHTML,{key:o,className:"og-dropdown__item","data-value":o},t)}))},J=({items:e=[],onSelect:t})=>{const[o,n]=(0,i.useState)("");return(0,r.createElement)("div",{onClick:e=>e.target.matches(".og-dropdown__item")&&t(e)},(0,r.createElement)(K,{handleSearch:e=>n(e.target.value)}),(0,r.createElement)(Q,{items:e,searchTerm:o}))},Y=({items:e=[],required:t=!1,className:o="",isID:n=!1,exclude:a=[],onChange:l,onSelect:s,...d})=>{const{getPrefix:u}=W(),[c,p]=(0,i.useState)(),m=(0,i.useRef)();return(0,i.useLayoutEffect)((()=>{c&&m.current&&([m.current.selectionStart,m.current.selectionEnd]=c)}),[c]),(0,r.createElement)("div",{className:`og-field-insert ${o}`},(0,r.createElement)("input",{ref:m,type:"text",required:t,onChange:e=>{p([e.target.selectionStart,e.target.selectionEnd]),l&&l(m,e.target.value)},...d}),e.length>0&&(0,r.createElement)(g.Dropdown,{className:"og-dropdown",placement:"bottom left",renderToggle:({onToggle:e})=>(0,r.createElement)(g.Button,{icon:"ellipsis",onClick:e}),renderContent:({onToggle:t})=>(0,r.createElement)(J,{items:e,onSelect:e=>((e,t)=>{t(),s?s(m,e.target.dataset.value):m.current.value=!n||a.includes(e.target.dataset.value)?e.target.dataset.value:`${u()||""}${e.target.dataset.value}`})(e,t)})}))},X=({keysList:e,valuesList:t,item:o,remove:n,keyPlaceholder:l,valuePlaceholder:s,updateItem:d})=>{const[u,c]=(0,i.useState)(t),p=(e,r)=>{e.current.value=r,d(o.id,"key",r);const n=1==Z(t)?t:Array.isArray(t[r])?t[r]:t.default;c(n||[])},m=(e,t)=>{e.current.value=t,d(o.id,"value",t)};return(0,r.createElement)("div",{className:"og-attribute mb-ruleset__rule"},(0,r.createElement)(Y,{placeholder:l,defaultValue:o.key,items:e,onSelect:p,onChange:p}),(0,r.createElement)(Y,{placeholder:s,defaultValue:o.value,items:u,onSelect:m,onChange:m}),(0,r.createElement)(g.Button,{variant:"link",isDestructive:!0,onClick:()=>n(o.id),text:(0,a.__)("Remove","meta-box-builder")}))},Z=e=>Object(e)===e?1+Math.max(-1,...Object.values(e).map(Z)):0,ee=({defaultValue:e,name:t,keyPlaceholder:o=(0,a.__)("Enter key","meta-box-builder"),valuePlaceholder:n=(0,a.__)("Enter value","meta-box-builder"),keys:l=[],values:s=[],description:d="",className:u="og-attribute-wrapper",updateField:c,...p})=>{const m=(h=e,Array.isArray(h)?h.reduce(((e,t)=>(e[t.id]=t,e)),{}):"object"==typeof h?h:{});var h;const b=e=>{const o={...m};delete o[e],c(t,o)},_=(e,o,r)=>c(t,{...m,[e]:{...m[e],[o]:r}});return(0,r.createElement)(j,{className:u,...p},d&&(0,r.createElement)(i.RawHTML,{className:"og-description"},d),Object.values(m||{}).map((e=>(0,r.createElement)(X,{key:e.id,item:e,remove:b,keysList:l,values:`${t}-values`,valuesList:s,keyPlaceholder:o,valuePlaceholder:n,updateItem:_}))),(0,r.createElement)(g.Button,{variant:"secondary",size:"compact",onClick:()=>{const e={key:"",value:"",id:f()};c(t,{...m,[e.id]:e})},text:(0,a.__)("+ Add New","meta-box-builder")}))};function te(){return te=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)({}).hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e},te.apply(null,arguments)}const oe=r.useLayoutEffect;var re=function(e,t){"function"!=typeof e?e.current=t:e(t)},ne={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},ie=function(e){Object.keys(ne).forEach((function(t){e.style.setProperty(t,ne[t],"important")}))},ae=null,le=function(e,t){var o=e.scrollHeight;return"border-box"===t.sizingStyle.boxSizing?o+t.borderSize:o-t.paddingSize},se=function(){},de=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak","wordSpacing","scrollbarGutter"],ue=!!document.documentElement.currentStyle;function ce(e,t,o){var i,a,l=(i=o,a=n().useRef(i),oe((function(){a.current=i})),a);r.useLayoutEffect((function(){var o=function(e){return l.current(e)};if(e)return e.addEventListener(t,o),function(){return e.removeEventListener(t,o)}}),[])}var pe=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],me=function(e,t){var o,i=e.cacheMeasurements,a=e.maxRows,l=e.minRows,s=e.onChange,d=void 0===s?se:s,u=e.onHeightChange,c=void 0===u?se:u,p=function(e,t){if(null==e)return{};var o={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;o[r]=e[r]}return o}(e,pe),m=void 0!==p.value,f=r.useRef(null),h=function(e,t){var o=n().useRef();return n().useCallback((function(r){e.current=r,o.current&&re(o.current,null),o.current=t,t&&re(t,r)}),[t])}(f,t),b=r.useRef(0),g=r.useRef(),_=function(){var e=f.current,t=i&&g.current?g.current:function(e){var t=window.getComputedStyle(e);if(null===t)return null;var o,r=(o=t,de.reduce((function(e,t){return e[t]=o[t],e}),{})),n=r.boxSizing;return""===n?null:(ue&&"border-box"===n&&(r.width=parseFloat(r.width)+parseFloat(r.borderRightWidth)+parseFloat(r.borderLeftWidth)+parseFloat(r.paddingRight)+parseFloat(r.paddingLeft)+"px"),{sizingStyle:r,paddingSize:parseFloat(r.paddingBottom)+parseFloat(r.paddingTop),borderSize:parseFloat(r.borderBottomWidth)+parseFloat(r.borderTopWidth)})}(e);if(t){g.current=t;var o=function(e,t,o,r){void 0===o&&(o=1),void 0===r&&(r=1/0),ae||((ae=document.createElement("textarea")).setAttribute("tabindex","-1"),ae.setAttribute("aria-hidden","true"),ie(ae)),null===ae.parentNode&&document.body.appendChild(ae);var n=e.paddingSize,i=e.borderSize,a=e.sizingStyle,l=a.boxSizing;Object.keys(a).forEach((function(e){var t=e;ae.style[t]=a[t]})),ie(ae),ae.value=t;var s=le(ae,e);ae.value=t,s=le(ae,e),ae.value="x";var d=ae.scrollHeight-n,u=d*o;"border-box"===l&&(u=u+n+i),s=Math.max(u,s);var c=d*r;return"border-box"===l&&(c=c+n+i),[s=Math.min(c,s),d]}(t,e.value||e.placeholder||"x",l,a),r=o[0],n=o[1];b.current!==r&&(b.current=r,e.style.setProperty("height",r+"px","important"),c(r,{rowHeight:n}))}};return r.useLayoutEffect(_),function(e,t){ce(document.body,"reset",(function(o){e.current.form===o.target&&t()}))}(f,(function(){if(!m){var e=f.current.value;requestAnimationFrame((function(){var t=f.current;t&&e!==t.value&&_()}))}})),ce(window,"resize",_),o=_,ce(document.fonts,"loadingdone",o),r.createElement("textarea",te({},p,{onChange:function(e){m||_(),d(e)},ref:h}))},fe=r.forwardRef(me);const he=({componentId:e,name:t,defaultValue:o,placeholder:n,textareaClassName:i="",updateField:a,...l})=>(0,r.createElement)(j,{...l,htmlFor:e},(0,r.createElement)(fe,{id:e,minRows:2,maxRows:6,placeholder:n,className:i,defaultValue:o,onChange:e=>a(t,e.target.value)})),be=({id:e})=>{const{getSetting:t,updateSetting:o}=W(),n="from"===e?(0,a.__)("to","meta-box-builder"):(0,a.__)("from","meta-box-builder");return(0,r.createElement)(r.Fragment,null,(0,r.createElement)(g.Notice,{status:"warning",isDismissible:!1},(0,r.createElement)(i.RawHTML,null,(0,a.sprintf)((0,a.__)('These settings apply to the field that is displayed on the other side ("%s") of the relationship - where you can select entries for this field.',"meta-box-builder"),`<strong>${n}</strong>`))),(0,r.createElement)(P,{name:`${e}.field.name`,label:(0,a.__)("Label","meta-box-builder"),defaultValue:t(`${e}.field.name`),description:(0,a.__)("The name of the field. Some page builders use this name to select the field to display.","meta-box-builder"),updateField:o}),(0,r.createElement)(P,{name:`${e}.field.label_description`,label:(0,a.__)("Label description","meta-box-builder"),description:(0,a.__)("Display below the field label","meta-box-builder"),defaultValue:t(`${e}.field.label_description`),updateField:o}),(0,r.createElement)(P,{name:`${e}.field.desc`,label:(0,a.__)("Input description","meta-box-builder"),description:(0,a.__)("Display below the field input","meta-box-builder"),defaultValue:t(`${e}.field.desc`),updateField:o}),(0,r.createElement)(P,{name:`${e}.field.placeholder`,label:(0,a.__)("Placeholder","meta-box-builder"),defaultValue:t(`${e}.field.placeholder`),updateField:o}),(0,r.createElement)(M,{name:`${e}.field.add_new`,label:(0,a.__)("Add new","meta-box-builder"),defaultValue:t(`${e}.field.add_new`),updateField:o}),(0,r.createElement)(ee,{name:`${e}.field.query_args`,label:(0,a.__)("Query args","meta-box-builder"),description:(0,a.__)("Query arguments for getting items.","meta-box-builder"),defaultValue:t(`${e}.field.query_args`),updateField:o}),(0,r.createElement)(P,{name:`${e}.field.max_clone`,label:(0,a.__)("Max items","meta-box-builder"),description:(0,a.__)("Set to 1 to set 1-n relationship or 1-1 relationship. Leave empty for unlimited items, e.g. n-n relationship.","meta-box-builder"),type:"number",defaultValue:t(`${e}.field.max_clone`),updateField:o}),(0,r.createElement)(P,{name:`${e}.field.add_button`,label:(0,a.__)("Add more text","meta-box-builder"),description:(0,a.__)('Custom text for the the "+ Add more" button. Leave empty to use the default text.',"meta-box-builder"),defaultValue:t(`${e}.field.add_button`),updateField:o}),(0,r.createElement)(he,{name:`${e}.field.before`,label:(0,a.__)("Before","meta-box-builder"),description:(0,a.__)("Custom HTML displayed before the field output","meta-box-builder"),defaultValue:t(`${e}.field.before`),updateField:o}),(0,r.createElement)(he,{name:`${e}.field.after`,label:(0,a.__)("After","meta-box-builder"),description:(0,a.__)("Custom HTML displayed after the field output","meta-box-builder"),defaultValue:t(`${e}.field.after`),updateField:o}),(0,r.createElement)(P,{name:`${e}.field.class`,label:(0,a.__)("Custom CSS class","meta-box-builder"),defaultValue:t(`${e}.field.class`),updateField:o}))},ge=z(((e,t)=>({fieldIds:[],addFieldId:t=>e((e=>({fieldIds:[...e.fieldIds,t]}))),removeFieldId:t=>e((e=>({fieldIds:e.fieldIds.filter((e=>e!==t))}))),hasCustomColumns:()=>t().fieldIds.length>0,init:t=>e({fieldIds:t})})));document.body.dataset.navPanel="field-group-settings";const _e=z(((e,t)=>({navPanel:"field-group-settings",setNavPanel:o=>{t().navPanel!==o&&(e((e=>({navPanel:o}))),document.body.dataset.navPanel=o)}}))),ye=new Map,ve=({id:e="",fields:t=[]})=>{if(ye.has(e))return ye.get(e);const o=z(((o,r)=>({id:e,fields:t,addFieldAt:(e,t)=>{const{fields:n}=r(),{setNavPanel:i}=_e.getState();if(t<0||t>n.length)return void console.error(`%cInvalid position: ${t}.`,"color:red");const a=(e=>{const t=`${e}_${f()}`;return{_id:t,_new:!0,type:e,id:t,name:m(e,"_")}})(e);o((e=>({fields:[...e.fields.slice(0,t),a,...e.fields.slice(t)]}))),"group"===e&&ve({id:a._id,fields:[]}),we(a._id),i("field-settings")},addField:e=>r().addFieldAt(e,r().fields.length),prependField:e=>r().addFieldAt(e,0),addFieldBefore:(e,t)=>r().addFieldAt(t,r().fields.findIndex((t=>t._id===e))),addFieldAfter:(e,t)=>r().addFieldAt(t,r().fields.findIndex((t=>t._id===e))+1),duplicateField:e=>{const{fields:t}=r(),n=t.find((t=>t._id===e));if(!n)return;const i=structuredClone(n),l=`${i.type}_${f()}`;delete i._active,delete i._id_changed,delete i.chosen,delete i.selected,i._original_id=n._id,i.id=l,i._id=l,i.name+=(0,a.__)(" (Copy)","meta-box-builder"),o((t=>{const o=t.fields.findIndex((t=>t._id===e));let r=[...t.fields];return r.splice(o+1,0,i),{fields:r}}));const s=e=>ve({id:e._id,fields:d(e)}),d=e=>ye.get(e._original_id).getState().fields.map((e=>{const t=structuredClone(e);t._original_id=e._id;const o=`${t.type}_${f()}`;return t.id=o,t._id=o,"group"===e.type&&s(t),t}));"group"===i.type&&s(i)},removeField:e=>{const{navPanel:t,setNavPanel:n}=_e.getState(),{removeFieldId:i}=ge.getState(),a=r(),l=a.fields.findIndex((t=>t._id===e)),s=l>=0&&a.fields[l]._active,d="root"!==a.id;if(o((t=>({fields:t.fields.filter((t=>t._id!==e))}))),i(e),!s)return;const u=r();let c=null;u.fields.length>0&&(l<u.fields.length?c=u.fields[l]._id:l>0&&(c=u.fields[l-1]._id)),c?we(c):d?we(a.id):n("field-group-settings")},updateField:(e,t,n)=>{const i=r().fields.find((t=>t._id===e));if(!i)return;const a=c().get(i,t);if(a===n)return;"type"===t&&"group"===n&&"group"!==a&&ve({id:e,fields:[]});const l=structuredClone(i);if(c().set(l,t,n),o((t=>({fields:t.fields.map((t=>t._id===e?l:t))}))),"columns"===t){const{removeFieldId:t,addFieldId:o}=ge.getState();12!=n&&n?o(e):t(e)}},moveFieldUp:e=>o((t=>{const o=t.fields.findIndex((t=>t._id===e));if(o<=0)return t;let r=[...t.fields];return[r[o-1],r[o]]=[r[o],r[o-1]],{fields:r}})),moveFieldDown:e=>o((t=>{const o=t.fields.findIndex((t=>t._id===e));if(o>=t.fields.length-1)return t;let r=[...t.fields];return[r[o],r[o+1]]=[r[o+1],r[o]],{fields:r}})),setFields:e=>{var t,n;t=r().fields,n=e,t.length===n.length&&t.every(((e,t)=>e._id===n[t]._id))||o({fields:e})}})));return ye.set(e,o),o},xe=(e,t)=>{let o=h(e.fields);o=o.filter((e=>e.type)),ve({id:t,fields:o}),o.forEach((e=>{"group"===e.type&&xe(e,e._id)}))};xe(MbbApp,"root");const Ee=e=>[...ye.values()].find((t=>t.getState().fields.some((t=>t._id===e)))),we=e=>{const t=Ee(e);t&&t.getState().updateField(e,"_active",!0),[...ye.values()].flatMap((e=>e.getState().fields)).forEach((t=>{if(t._id===e||!t._active)return;const o=Ee(t._id);o&&o.getState().updateField(t._id,"_active",!1)}))},Se=[...ye.values()].flatMap((e=>e.getState().fields)).filter((e=>e.columns&&12!=e.columns)).map((e=>e._id));ge.getState().init(Se);const Ce=e=>"term"===e?[["cb",(0,a.__)("Checkbox","meta-box-builder")],["name",(0,a.__)("Name","meta-box-builder")],["description",(0,a.__)("Description","meta-box-builder")],["slug",(0,a.__)("Slug","meta-box-builder")],["count",(0,a.__)("Count","meta-box-builder")]]:"user"===e?[["cb",(0,a.__)("Checkbox","meta-box-builder")],["username",(0,a.__)("Username","meta-box-builder")],["name",(0,a.__)("Name","meta-box-builder")],["email",(0,a.__)("Email","meta-box-builder")],["role",(0,a.__)("Role","meta-box-builder")],["posts",(0,a.__)("Posts","meta-box-builder")]]:[["cb",(0,a.__)("Checkbox","meta-box-builder")],["title",(0,a.__)("Title","meta-box-builder")],["author",(0,a.__)("Author","meta-box-builder")],["categories",(0,a.__)("Categories","meta-box-builder")],["tags",(0,a.__)("Tags","meta-box-builder")],["comments",(0,a.__)("Comments","meta-box-builder")],["date",(0,a.__)("Date","meta-box-builder")]],ke=({name:e,defaultValue:t,updateField:o,...n})=>{const{getObjectType:l}=W(),s=l(),d={term:"name",user:"username"}[s]||"title";let u=(()=>{const[e,t]=(0,i.useState)([]);return(0,i.useEffect)((()=>{const e=[],o=()=>{const e=Array.from(ye.values()).flatMap((e=>e.getState().fields));t(e)};return ye.forEach((t=>{const r=t.subscribe((()=>{o()}));e.push(r)})),o(),()=>{e.forEach((e=>e()))}}),[]),e})().map((e=>[e.id,`${e.name} (${e.id})`]));return u=[...Ce(s),...u],(0,i.useEffect)((()=>{let r,n,i=!1;if("string"==typeof t){const e=t.split(" ");r=e[0]||"after",n=e[1]||d,i=!0}else t.type||(r="after",i=!0),t.column||(n=d,i=!0);i&&(r&&o(`${e}.type`,r),n&&o(`${e}.column`,n))}),[JSON.stringify(t)]),(0,r.createElement)(j,{...n},(0,r.createElement)("select",{defaultValue:t?.type,onChange:t=>o(`${e}.type`,t.target.value)},(0,r.createElement)("option",{value:"after"},(0,a.__)("After","meta-box-builder")),(0,r.createElement)("option",{value:"before"},(0,a.__)("Before","meta-box-builder")),(0,r.createElement)("option",{value:"replace"},(0,a.__)("Replace","meta-box-builder"))),(0,r.createElement)(Y,{defaultValue:t?.column,items:u,isID:!0,exclude:Ce(s),onChange:(t,r)=>o(`${e}.column`,r),onSelect:(t,r)=>{t.current.value=r,o(`${e}.column`,r)}}))},Fe=({componentId:e,name:t,options:o,defaultValue:n,onChange:i,placeholder:a,updateField:l,...s})=>{const d=F(e),u=o&&"object"==typeof o&&Object.values(o).some((e=>"object"==typeof e&&null!==e));return(0,r.createElement)(j,{htmlFor:e,...s},(0,r.createElement)("select",{id:e,defaultValue:n,onChange:e=>{d(),i&&i(e),l(t,e.target.value)}},(0,r.createElement)("option",{value:""},a),u?Object.entries(o||{}).map((([e,t])=>"object"==typeof t&&null!==t?(0,r.createElement)("optgroup",{key:e,label:e},Object.entries(t).map((([e,t])=>(0,r.createElement)("option",{key:e,value:e},t)))):(0,r.createElement)("option",{key:e,value:e},t))):Object.entries(o||{}).map((([e,t])=>(0,r.createElement)("option",{key:e,value:e},t)))))},De=({name:e,options:t,defaultValue:o,updateField:n,...i})=>{const a=t=>n&&t.target.checked&&n(e,t.target.value);return(0,r.createElement)(j,{...i},(0,r.createElement)("div",{className:"og-toggle-group"},Object.entries(t).map((([t,n])=>(0,r.createElement)("label",{key:t},(0,r.createElement)("input",{type:"radio",name:e,defaultValue:t,defaultChecked:t==o,onChange:a}),(0,r.createElement)("span",{className:"dashicons dashicons-yes-alt"}),(0,r.createElement)("span",null,n))))))},$e=({id:e})=>{const{getSetting:t,updateSetting:o}=W();return(0,r.createElement)(r.Fragment,null,(0,r.createElement)(De,{name:`${e}.object_type`,label:(0,a.__)("Object type","meta-box-builder"),options:MbbApp.object_types,defaultValue:t(`${e}.object_type`,"post"),updateField:o}),"post"===t(`${e}.object_type`,"post")&&(0,r.createElement)(Fe,{name:`${e}.post_type`,label:(0,a.__)("Post type","meta-box-builder"),options:MbbApp.post_types,defaultValue:t(`${e}.post_type`,"post"),updateField:o}),"term"===t(`${e}.object_type`)&&(0,r.createElement)(Fe,{name:`${e}.taxonomy`,label:(0,a.__)("Taxonomy","meta-box-builder"),options:MbbApp.taxonomies,defaultValue:t(`${e}.taxonomy`,"category"),updateField:o}),(0,r.createElement)(P,{name:`${e}.empty_message`,label:(0,a.__)("Empty message","meta-box-builder"),description:(0,a.__)("The message displayed when there's no connections","meta-box-builder"),defaultValue:t(`${e}.empty_message`),updateField:o}),"post"===t(`${e}.object_type`,"post")&&(0,r.createElement)(M,{name:`${e}.admin_filter`,label:(0,a.__)("Show admin filter","meta-box-builder"),description:(0,a.__)("Show a dropdown filter by this relationship in the admin table list.","meta-box-builder"),defaultValue:t(`${e}.admin_filter`),updateField:o}),(0,r.createElement)(M,{name:`${e}.admin_column.enable`,label:(0,a.__)("Show as an admin column","meta-box-builder"),description:(0,a.__)("Show this connection as a column in the table list in the admin.","meta-box-builder"),defaultValue:t(`${e}.admin_column.enable`),updateField:o}),t(`${e}.admin_column.enable`)&&(0,r.createElement)(r.Fragment,null,(0,r.createElement)(ke,{name:`${e}.admin_column.position`,label:(0,a.__)("Column position","meta-box-builder"),className:"og-admin-columns-position",description:(0,a.__)("Specify where to show the column in the table","meta-box-builder"),defaultValue:t(`${e}.admin_column.position`,{}),updateField:o}),(0,r.createElement)(P,{name:`${e}.admin_column.title`,label:(0,a.__)("Column title","meta-box-builder"),description:(0,a.__)("Leave empty to use the meta box title","meta-box-builder"),defaultValue:t(`${e}.admin_column.title`),updateField:o}),(0,r.createElement)(Fe,{name:`${e}.admin_column.link`,label:(0,a.__)("Item link type","meta-box-builder"),description:(0,a.__)("The link for the items displayed in the admin column","meta-box-builder"),options:{view:(0,a.__)("View","meta-box-builder"),edit:(0,a.__)("Edit","meta-box-builder"),false:(0,a.__)("No link","meta-box-builder")},defaultValue:t(`${e}.admin_column.link`,"view"),updateField:o})))},Ne=({id:e})=>{const{getSetting:t,updateSetting:o}=W();return(0,r.createElement)(r.Fragment,null,(0,r.createElement)(P,{name:`${e}.meta_box.title`,label:(0,a.__)("Title","meta-box-builder"),defaultValue:t(`${e}.meta_box.title`),updateField:o}),(0,r.createElement)(De,{name:`${e}.meta_box.context`,label:(0,a.__)("Position","meta-box-builder"),options:{normal:(0,a.__)("After content","meta-box-builder"),side:(0,a.__)("Side","meta-box-builder")},defaultValue:t(`${e}.meta_box.context`,"side"),updateField:o}),(0,r.createElement)(De,{name:`${e}.meta_box.priority`,label:(0,a.__)("Priority","meta-box-builder"),options:{low:(0,a.__)("Low","meta-box-builder"),high:(0,a.__)("High","meta-box-builder")},defaultValue:t(`${e}.meta_box.priority`,"low"),updateField:o}),(0,r.createElement)(De,{name:`${e}.meta_box.style`,label:(0,a.__)("Style","meta-box-builder"),options:{default:(0,a.__)("Default","meta-box-builder"),seamless:(0,a.__)("Seamless","meta-box-builder")},defaultValue:t(`${e}.meta_box.style`,"default"),updateField:o}),(0,r.createElement)(M,{name:`${e}.meta_box.closed`,label:(0,a.__)("Collapsed by default","meta-box-builder"),defaultValue:t(`${e}.meta_box.closed`),updateField:o}),(0,r.createElement)(P,{name:`${e}.meta_box.class`,label:(0,a.__)("Custom CSS class","meta-box-builder"),defaultValue:t(`${e}.meta_box.class`),updateField:o}))},Oe=({id:e,title:t})=>{const o=[{name:"general",title:(0,a.__)("General","meta-box-builder")},{name:"meta-box",title:(0,a.__)("Meta Box","meta-box-builder")},{name:"field",title:(0,a.__)("Field","meta-box-builder")}],n={general:(0,r.createElement)($e,{id:e}),"meta-box":(0,r.createElement)(Ne,{id:e}),field:(0,r.createElement)(be,{id:e})};return(0,r.createElement)(g.PanelBody,{title:t},(0,r.createElement)(g.TabPanel,{tabs:o},(e=>n[e.name])))},Ve=()=>(0,r.createElement)("div",{className:"mb-content"},(0,r.createElement)(G,null),(0,r.createElement)(Oe,{id:"from",title:(0,a.__)("From","meta-box-builder")}),(0,r.createElement)(Oe,{id:"to",title:(0,a.__)("To","meta-box-builder")})),je=window.wp.compose;var Me=o(388);const Pe=window.wp.apiFetch;var Te=o.n(Pe);const Ae=window.wp.url,Re={},Le=({api:e,params:t={},method:o="GET",cache:r=!0})=>{const n=JSON.stringify({api:e,params:t,method:o});if(r&&Re[n])return Re[n];let i=`/mbb/${e}`;"GET"===o&&(i=(0,Ae.addQueryArgs)(i,t));const a=Te()({path:i,method:o,data:"POST"===o?t:null});return Re[n]=a,a},Ie=()=>{const{getSetting:e,updateSetting:t,settings:o}=W(),[n,l]=(0,i.useState)(""),[s,d]=(0,i.useState)(!1),[u,c]=(0,i.useState)(!1),p=(0,je.useCopyToClipboard)(n,(()=>{c(!0),setTimeout((()=>c(!1)),2e3)}));return(0,r.createElement)("div",{className:"mb-php"},(0,r.createElement)(P,{name:"text_domain",label:(0,a.__)("Text domain","meta-box-builder"),tooltip:(0,a.__)("Required for multilingual website. Used in the exported code only.","meta-box-builder"),defaultValue:e("text_domain","your-text-domain"),componentId:"text-domain",updateField:t}),(0,r.createElement)(P,{name:"function_name",label:(0,a.__)("Function name","meta-box-builder"),defaultValue:e("function_name","your_prefix_function_name"),componentId:"function-name",updateField:t}),(0,r.createElement)("button",{type:"button",className:"button",onClick:()=>{l(""),d(!0),Le({api:"relationships/generate",params:{post_title:document.querySelector("#post_title")?.value,settings:o},method:"POST"}).then((e=>{l(e),d(!1)}))},disabled:s},(0,a.__)("Generate","meta-box-builder")),s&&(0,r.createElement)("p",null,(0,a.__)("Generating code, please wait...","meta-box-builder")),n.length>0&&(0,r.createElement)("div",{className:"og-result"},(0,r.createElement)("p",null,(0,a.__)("Copy the code and paste into your theme's functions.php file.","meta-box-builder")),(0,r.createElement)("div",{className:"og-result__body"},(0,r.createElement)(Me.wN,{value:n,options:{mode:"php",lineNumbers:!0,readOnly:!0}}),(0,r.createElement)("button",{type:"button",className:"button",text:n,ref:p},u?(0,a.__)("Copied!","meta-box-builder"):(0,a.__)("Copy","meta-box-builder")))))},Be=()=>{const[e,t]=(0,i.useState)("settings"),o={settings:(0,a.__)("Settings","meta-box-builder"),php:(0,a.__)("Get PHP Code","meta-box-builder")},n={settings:C,php:k};return(0,r.createElement)("div",{className:"mb-main"},(0,r.createElement)("div",{className:"wp-header-end"}),(0,r.createElement)("div",{className:"mb-box"},(0,r.createElement)(g.Flex,{align:"center",className:"mb-box__header"},(0,r.createElement)(g.Icon,{icon:n[e]}),(0,r.createElement)("span",{className:"mb-box__title"},o[e]),(0,r.createElement)(g.Button,{size:"small",icon:C,onClick:()=>t("settings"),label:(0,a.__)("Show settings","meta-box-builder"),showTooltip:!0}),(0,r.createElement)(g.Button,{size:"small",icon:k,onClick:()=>t("php"),label:(0,a.__)("Get PHP code to register the relationship","meta-box-builder"),showTooltip:!0})),(0,r.createElement)("div",{className:"mb-box__body"},"settings"===e&&(0,r.createElement)(Ve,null),"php"===e&&(0,r.createElement)(Ie,null))))},Ue=()=>{const[e,t]=(0,i.useState)(!1),o=()=>t(!1);return window.mbbShowNotification=()=>{t(!0),setTimeout(o,3e3)},e&&(0,r.createElement)(g.Snackbar,{className:"mb-notification",explicitDismiss:!0,onDismiss:o},(0,a.__)("Relationship is updated.","meta-box-builder"))},ze=({children:e})=>(0,r.createElement)(d,{fallback:(0,r.createElement)("p",null,(0,a.__)("Something went wrong. Please try again!","meta-box-builder"))},(0,r.createElement)(E,null),(0,r.createElement)("div",{className:"mb-body"},(0,r.createElement)("div",{className:"mb-body__inner"},e)),(0,r.createElement)(Ue,null)),He=document.getElementById("poststuff");He.classList.add("mb"),He.classList.add("og"),He.id="mb-app",(0,i.createRoot)(He).render((0,r.createElement)((()=>(0,r.createElement)(ze,null,(0,r.createElement)(Be,null))),null)),(()=>{const e=document.querySelector("#post_ID")?.value;e&&location.href.includes("post-new.php")&&history.replaceState({},"",`${MbbApp.adminUrl}post.php?post=${e}&action=edit`)})(),document.querySelector(".wp-header-end")?.remove();const qe=document.querySelector("#post"),We=e=>{"INPUT"===e.target.tagName&&13==e.keyCode&&e.preventDefault()};qe.addEventListener("keypress",We),qe.addEventListener("keydown",We),qe.addEventListener("keyup",We),(()=>{const e=document.getElementById("post");e&&e.addEventListener("submit",(async e=>{e.preventDefault();const t=e.submitter;if(!t)return;t.disabled=!0;const o=t.value;t.value=MbbApp.texts.saving;const r=W.getState().settings;try{const e=await Le({api:"relationships/save",params:{post_id:document.querySelector("#post_ID").value,post_title:document.querySelector("#post_title").value,settings:r},method:"POST",cache:!1});if(!e.success)return void alert(e.message);window.mbbShowNotification?.()}catch(e){let t=e.message;e.data?.details&&!Array.isArray(e.data?.details)&&(t=Object.values(e.data?.details).map((e=>e.message)).join("\n")),alert(t)}finally{t.value=o,t.disabled=!1}}))})()})();